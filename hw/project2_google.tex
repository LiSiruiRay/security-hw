\documentclass[11pt]{article}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{xcolor}

\lstset{
    basicstyle=\ttfamily\small,
    breaklines=true,
    frame=single,
    backgroundcolor=\color{gray!10}
}

\newcommand{\needstool}[1]{\textcolor{red}{#1}}
\newcommand{\requiresaccess}[1]{\textcolor{red}{[REQUIRES ACCESS: #1]}}

\title{Project 2: Network Reconnaissance\\Domain Analysis: google.com}
\author{Ray Li}
\date{November 11, 2025}

\begin{document}

\maketitle

\section{Domain: google.com (Commercial)}

\subsection{Domain Registration}

\textbf{Command:} \texttt{whois google.com}

\begin{enumerate}
    \item[(a)] \textbf{Official registrant:} Google LLC. The domain is registered openly (not privately or by proxy).
    
    \item[(b)] \textbf{Contact information:} 
    \begin{itemize}
        \item Phone number: +1.2086851750 (Registrar abuse contact via MarkMonitor Inc.)
        \item Physical address: Not provided in whois output
        \item Email: Contact forms available through \url{https://domains.markmonitor.com/whois/google.com}
        \item Registrar: MarkMonitor Inc. (Registrar IANA ID: 292)
    \end{itemize}
    
    \item[(c)] \textbf{Domain dates:}
    \begin{itemize}
        \item Creation Date: September 15, 1997
        \item Expiry Date: September 14, 2028
        \item Domain age: Approximately 28 years old
    \end{itemize}
\end{enumerate}

\subsection{DNS Analysis}

\textbf{Commands:} \texttt{dig www.google.com A}, \texttt{dig google.com MX}, \texttt{dig google.com NS}

\begin{enumerate}
    \item[(a)] \textbf{IP Address:} 142.250.65.228 (IPv4) and 2607:f8b0:4006:817::2004 (IPv6)
    
    \item[(b)] \textbf{Geolocation:} \requiresaccess{Browser access to \url{http://iplocation.net}}
    \begin{itemize}
        \item \needstool{Geolocation lookup not completed - requires web browser access}
    \end{itemize}
    
    \item[(c)] \textbf{DNS Records returned:}
    \begin{itemize}
        \item A record: 142.250.65.228
        \item AAAA record: 2607:f8b0:4006:817::2004
        \item NS records: ns1.google.com, ns2.google.com, ns3.google.com, ns4.google.com
        \item SOA record: Primary nameserver ns1.google.com, admin email dns-admin.google.com
    \end{itemize}
    
    \item[(d)] \textbf{Mail server:} Yes, google.com has MX record pointing to smtp.google.com (priority 10)
    
    \item[(e)] \textbf{DNSSEC support:} unsigned (from whois output)
\end{enumerate}

\subsection{IP Routing}

\textbf{Command:} \texttt{traceroute www.google.com}

\begin{enumerate}
    \item[(a)] \textbf{Number of hops:} Approximately 12 hops from my location
    
    \item[(b)] \textbf{Route consistency:} No, packets took different routes. At hop 10, three different IP addresses were observed (142.251.65.108, 216.239.43.62, 142.250.46.190), indicating load balancing or multiple paths.
    
    \item[(c)] \textbf{Identifiable routers:} 9 out of 12 hops were identifiable. Hops 6, 7, and 9 showed asterisks (*), indicating routers that did not respond to ICMP probes.
    
    \item[(d)] \textbf{Last identifiable router geolocation:}
    \begin{itemize}
        \item IP: 209.85.255.52 or 142.250.81.228 (last hop)
        \item Hostname: lga25s74-in-f4.1e100.net
        \item \requiresaccess{Browser access to \url{http://iplocation.net}} \needstool{Geolocation lookup not completed}
    \end{itemize}
\end{enumerate}

\subsection{TCP Port Scanning}

\textbf{Command:} \texttt{nmap www.google.com}

\requiresaccess{nmap command-line tool not installed}

\begin{enumerate}
    \item[(a)] \needstool{Port scan results not available - nmap tool required for installation}
\end{enumerate}

\subsection{PKI Certificate Analysis}

\textbf{Command:} \texttt{openssl s\_client -connect www.google.com:443 -servername www.google.com}

\begin{enumerate}
    \item[(a)] \textbf{Cipher suite:} TLS\_AES\_256\_GCM\_SHA384 (TLS 1.3)
    
    \item[(b)] \textbf{Public key:} 
    \begin{itemize}
        \item Type: Elliptic Curve (EC)
        \item Curve: P-256 (prime256v1)
        \item Size: 256 bits
    \end{itemize}
    
    \item[(c)] \textbf{Certificate validity:}
    \begin{itemize}
        \item Valid from: October 13, 2025 08:39:42 GMT
        \item Valid until: January 5, 2026 08:39:41 GMT
        \item Validity period: Approximately 84 days (about 3 months)
    \end{itemize}
    
    \item[(d)] \textbf{Root Certificate Authority:}
    \begin{itemize}
        \item Root CA: GlobalSign Root CA (C=BE, O=GlobalSign nv-sa, OU=Root CA, CN=GlobalSign Root CA)
        \item Intermediate CAs in chain:
        \begin{itemize}
            \item GTS Root R1 (C=US, O=Google Trust Services LLC, CN=GTS Root R1)
            \item WR2 (C=US, O=Google Trust Services, CN=WR2)
        \end{itemize}
        \item \needstool{Root CA key type and expiration date: Requires extracting and examining root certificate details}
    \end{itemize}
    
    \item[(e)] \textbf{Other domains:} Only www.google.com is listed in the Subject Alternative Names (SAN) field.
    
    \item[(f)] \textbf{Intermediate certificates:} 2 intermediate certificates in the chain:
    \begin{itemize}
        \item Certificate 1: WR2 (Google Trust Services)
        \item Certificate 2: GTS Root R1 (Google Trust Services LLC)
    \end{itemize}
    
    \item[(g)] \textbf{Extended Validation (EV):} No, this is a standard Domain Validated (DV) certificate (indicated by policy 2.23.140.1.2.1)
    
    \item[(h)] \textbf{Certificate revocation:}
    \begin{itemize}
        \item OCSP responder: Yes, \url{http://o.pki.goog/wr2}
        \item CRL distribution point: Yes, \url{http://c.pki.goog/wr2/oQ6nyr8F0m0.crl}
    \end{itemize}
    
    \item[(i)] \textbf{Certificate Transparency:}
    \begin{itemize}
        \item SCTs embedded: 2 Signed Certificate Timestamps found in certificate
        \item First logged: October 13, 2025 09:39:43 GMT (Log ID: 96:97:64:BF:...)
        \item Second logged: October 13, 2025 09:39:43 GMT (Log ID: 16:83:2D:AB:...)
        \item \requiresaccess{Browser access to \url{https://crt.sh}} \needstool{Total CT log count not retrieved}
    \end{itemize}
\end{enumerate}

\subsection{TLS Configuration}

\textbf{Reference:} Qualys SSL Labs (\url{https://www.ssllabs.com/ssltest/})

\requiresaccess{Browser access to SSL Labs required for complete analysis}

\textbf{Partial analysis from openssl testing:}

\begin{enumerate}
    \item[(a)] \textbf{TLS/SSL versions supported:}
    \begin{itemize}
        \item TLS 1.3: Confirmed supported (Protocol: TLSv1.3)
        \item \needstool{Complete version support list: Requires SSL Labs full report}
    \end{itemize}
    
    \item[(b)] \textbf{Most-preferred cipher suite:}
    \begin{itemize}
        \item Negotiated cipher: TLS\_AES\_256\_GCM\_SHA384
        \item Forward secrecy: Yes (TLS 1.3 provides forward secrecy)
        \item \needstool{Server's most-preferred cipher (vs. what was negotiated): Requires SSL Labs report}
    \end{itemize}
    
    \item[(c)] \textbf{Client compatibility:} \needstool{Requires SSL Labs client simulation results}
    
    \item[(d)] \textbf{HSTS support:} \needstool{Requires HTTP header inspection or SSL Labs report}
    
    \item[(e)] \textbf{SSL Labs grade:} \needstool{Requires accessing SSL Labs report}
\end{enumerate}

\subsection{Tor and VPN Analysis}

\requiresaccess{NYU VPN client, Tor Browser, and browser access to \url{https://2ip.io/}}

\begin{enumerate}
    \item[(a)] \textbf{Normal connection (no VPN/Tor):}
    \begin{itemize}
        \item \needstool{IP address: Requires browser access to 2ip.io}
        \item \needstool{Geolocation: Requires browser access to 2ip.io}
        \item \needstool{Reverse DNS: Requires DNS lookup tool}
    \end{itemize}
    
    \item[(b)] \textbf{Via NYU VPN and Tor:}
    \begin{itemize}
        \item \needstool{NYU VPN IP: Requires NYU VPN client installation and connection}
        \item \needstool{Tor IP: Requires Tor Browser installation}
    \end{itemize}
    
    \item[(c)] \textbf{Tor exit node details:}
    \begin{itemize}
        \item \requiresaccess{Tor Browser and access to \url{https://metrics.torproject.org/rs.html}}
        \item \needstool{Nickname: Requires Tor connection and relay search}
        \item \needstool{Uptime: Requires Tor connection and relay search}
        \item \needstool{Bandwidth: Requires Tor connection and relay search}
        \item \needstool{Flags: Requires Tor connection and relay search}
    \end{itemize}
    
    \item[(d)] \textbf{Access via VPN/Tor:}
    \begin{itemize}
        \item \needstool{Access testing: Requires NYU VPN and Tor Browser}
        \item \needstool{Rendering differences: Requires testing with both connections}
    \end{itemize}
\end{enumerate}

\section{Summary}

\subsection{Key Findings for google.com}

\textbf{Verified findings:}

\begin{itemize}
    \item \textbf{Domain maturity:} Domain created September 15, 1997 (28 years old), registered to Google LLC, expires September 14, 2028
    \item \textbf{DNS Infrastructure:} 
    \begin{itemize}
        \item Four nameservers: ns1.google.com, ns2.google.com, ns3.google.com, ns4.google.com
        \item Mail server: smtp.google.com (priority 10)
        \item IPv4 and IPv6 support confirmed (A and AAAA records present)
        \item DNSSEC: unsigned
    \end{itemize}
    \item \textbf{Network routing:} 12 hops observed, with load balancing evident (multiple IPs at hop 10)
    \item \textbf{Certificate details:}
    \begin{itemize}
        \item Public key: EC P-256 (256-bit)
        \item Validity: 84 days (Oct 13, 2025 to Jan 5, 2026)
        \item Issuer chain: WR2 (Google Trust Services) → GTS Root R1 → GlobalSign Root CA
        \item Certificate Transparency: 2 SCTs embedded
        \item Revocation: OCSP and CRL distribution point present
        \item Not an Extended Validation certificate
    \end{itemize}
    \item \textbf{TLS support:} TLS 1.3 confirmed with TLS\_AES\_256\_GCM\_SHA384 cipher
\end{itemize}

\textbf{Analysis limitations:}
\begin{itemize}
    \item \needstool{Complete TLS version support and preferred ciphers require SSL Labs}
    \item \needstool{Port scanning requires nmap installation}
    \item \needstool{Geolocation requires browser access to iplocation.net}
    \item \needstool{VPN and Tor analysis require client software installation}
\end{itemize}

\end{document}

